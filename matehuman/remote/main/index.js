System.register("chunks:///_virtual/actionsCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./eventMap.ts","./clientEvent.ts"],(function(t){"use strict";var n,e,i,o,c,r,l,a,s,u,p,h,d;return{setters:[function(t){n=t.applyDecoratedDescriptor,e=t.inheritsLoose,i=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){c=t.cclegacy,r=t._decorator,l=t.Button,a=t.Node,s=t.Component},function(t){u=t.PLAY_HELLO_ANI,p=t.SPEAK_WORDS,h=t.PLAY_DANCING_ANI},function(t){d=t.ClientEvent}],execute:function(){var f,v,y,A,_,E,C;c._RF.push({},"dc937/4HXtE34qxHjnSn1cM","actionsCtrl",void 0);var T=r.ccclass,B=(r.property,r.type);t("actionsCtrl",(f=T("actionsCtrl"),v=B(l),y=B(l),f((E=n((_=function(t){function n(){for(var n,e=arguments.length,c=new Array(e),r=0;r<e;r++)c[r]=arguments[r];return n=t.call.apply(t,[this].concat(c))||this,i(n,"danceBtn",E,o(n)),i(n,"helloBtn",C,o(n)),n}e(n,t);var c=n.prototype;return c.start=function(){this.helloBtn.node.on(a.EventType.TOUCH_START,this.helloAction,this),this.danceBtn.node.on(a.EventType.TOUCH_START,this.danceAction,this)},c.update=function(t){},c.helloAction=function(){d.dispatchEvent(u),d.dispatchEvent(p,"嗨，欢迎来到微众银行")},c.danceAction=function(){d.dispatchEvent(h)},n}(s)).prototype,"danceBtn",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=n(_.prototype,"helloBtn",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=_))||A));c._RF.pop()}}}));

System.register("chunks:///_virtual/clientEvent.ts",["cc"],(function(n){"use strict";var r,e;return{setters:[function(n){r=n.cclegacy,e=n._decorator}],execute:function(){var t,a;r._RF.push({},"0fe405MnhRMX5zoRmjsLkX+","clientEvent",void 0);var c=e.ccclass;e.property,n("ClientEvent",c("ClientEvent")(((a=function(){function n(){}return n.on=function(r,e,t){var a={handler:e,target:t},c=n._handlers[r];c||(c=[],n._handlers[r]=c);for(var l=0;l<c.length;l++)if(!c[l])return c[l]=a,l;return c.push(a),c.length},n.off=function(r,e,t){var a=n._handlers[r];if(a)for(var c=0;c<a.length;c++){var l=a[c];if(l.handler===e&&(!t||t===l.target)){a.splice(c,1);break}}},n.dispatchEvent=function(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),a=1;a<e;a++)t[a-1]=arguments[a];var c,l=n._handlers[r],i=[];for(c=1;c<arguments.length;c++)i.push(arguments[c]);if(l)for(c=0;c<l.length;c++){var h=l[c];h.handler&&h.handler.apply(h.target,i)}},n}())._handlers={},t=a))||t);r._RF.pop()}}}));

System.register("chunks:///_virtual/eventMap.ts",["cc"],(function(A){"use strict";var _;return{setters:[function(A){_=A.cclegacy}],execute:function(){_._RF.push({},"aebf2+LbmlFmr0UGwrzL2ZY","eventMap",void 0);A("PLAY_HEAD_ANI","PLAY_HEAD_ANI"),A("STOP_HEAD_ANI","STOP_HEAD_ANI"),A("PLAY_HELLO_ANI","PLAY_HELLO_ANI"),A("PLAY_TALKING_ANI","PLAY_TALKING_ANI"),A("PLAY_DANCING_ANI","PLAY_DANCING_ANI"),A("PLAY_STANDING_ANI","PLAY_STANDING_ANI"),A("SPEAK_WORDS","SPEAK_WORDS");_._RF.pop()}}}));

System.register("chunks:///_virtual/faceAniCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./eventMap.ts","./clientEvent.ts"],(function(t){"use strict";var e,s,o,i,r,n,h,l,a,p,c;return{setters:[function(t){e=t.applyDecoratedDescriptor,s=t.inheritsLoose,o=t.createClass},function(t){i=t.cclegacy,r=t._decorator,n=t.CCFloat,h=t.MeshRenderer,l=t.Component},function(t){a=t.PLAY_HEAD_ANI,p=t.STOP_HEAD_ANI},function(t){c=t.ClientEvent}],execute:function(){var g,m,u,f;i._RF.push({},"659bargVSpB3p590jrX9tBB","faceAniCtrl",void 0);var C=r.ccclass,_=r.property;t("faceAniCtrl",(g=C("faceAniCtrl"),m=_({type:[n],range:[0,1,.1],slide:!0}),g((e((f=function(t){function e(){for(var e,s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))||this)._weightsControl=[],e._modelComp=null,e._totalTargets=0,e.playing=!1,e.directionFlag=0,e.lastFrameTime=0,e.perFrameTime=1/60,e}s(e,t);var i=e.prototype;return i.setWeights=function(t){if(0!==t.length)for(var e=0;e<this._morph.subMeshMorphs.length;++e)this._morph.subMeshMorphs[e]&&this._modelComp.setWeights(t,e)},i.start=function(){if(this._modelComp=this.node.getComponent(h),this._modelComp){var t=this._modelComp.mesh;if(t&&(this._morph=t.struct.morph,this._morph))if(0!==this._morph.subMeshMorphs.length){var e=this._morph.subMeshMorphs.find((function(t){return!!t}));if(e){this._morph.subMeshMorphs.every((function(t){return!t||t.targets.length===e.targets.length}))||console.warn("not all submesh count are the same"),console.log(JSON.stringify(this._morph.targetNames));var s=this._morph.subMeshMorphs[0],o=s?s.targets.length:0;this._totalTargets=o,this.weightsControl=new Array(o).fill(0),c.on(a,this.play,this),c.on(p,this.stop,this)}else console.warn("all submesh don't have morph")}else console.warn("submesh count is 0")}},i.onSliderChanged=function(t,e){console.log(t,e);var s=Number.parseInt(e);this.weightsControl[s]=t.progress,this.weightsControl=this.weightsControl},i.update=function(t){this.lastFrameTime=this.lastFrameTime+t,this.lastFrameTime>=this.perFrameTime&&(this.lastFrameTime=0,this.doFrame())},i.doFrame=function(){var t=10*this.weightsControl[0];(0!==t||this.playing)&&(t>=10?this.directionFlag=1:t<=0&&(this.directionFlag=0),this.directionFlag?this.weightsControl[0]=(t-1)/10:this.weightsControl[0]=(t+1)/10,this.weightsControl=this.weightsControl)},i.play=function(){this.playing=!0},i.stop=function(){this.playing=!1},o(e,[{key:"weightsControl",get:function(){return this._weightsControl},set:function(t){t.length==this._totalTargets&&(this._weightsControl=t,this.setWeights(this._weightsControl))}}]),e}(l)).prototype,"weightsControl",[m],Object.getOwnPropertyDescriptor(f.prototype,"weightsControl"),f.prototype),u=f))||u));i._RF.pop()}}}));

System.register("chunks:///_virtual/faceNameMap.ts",["cc"],(function(e){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"b0f3ftMVpxKs6LIRY5ZDywv","faceNameMap",void 0);e("modelNames",["mouthOpen","mouthSmile","eyesClosed","eyesLookUp","eyesLookDown","viseme_sil","viseme_PP","viseme_FF","viseme_TH","viseme_DD","viseme_kk","viseme_CH","viseme_SS","viseme_nn","viseme_RR","viseme_aa","viseme_E","viseme_I","viseme_O","viseme_U","eyeBlinkLeft","eyeLookDownLeft","eyeLookInLeft","eyeLookOutLeft","eyeLookUpLeft","eyeSquintLeft","eyeWideLeft","eyeBlinkRight","eyeLookDownRight","eyeLookInRight","eyeLookOutRight","eyeLookUpRight","eyeSquintRight","eyeWideRight","jawForward","jawLeft","jawRight","jawOpen","mouthClose","mouthFunnel","mouthPucker","mouthLeft","mouthRight","mouthSmileLeft","mouthSmileRight","mouthFrownLeft","mouthFrownRight","mouthDimpleLeft","mouthDimpleRight","mouthStretchLeft","mouthStretchRight","mouthRollLower","mouthRollUpper","mouthShrugLower","mouthShrugUpper","mouthPressLeft","mouthPressRight","mouthLowerDownLeft","mouthLowerDownRight","mouthUpperUpLeft","mouthUpperUpRight","browDownLeft","browDownRight","browInnerUp","browOuterUpLeft","browOuterUpRight","cheekPuff","cheekSquintLeft","cheekSquintRight","noseSneerLeft","noseSneerRight","tongueOut"]);t._RF.pop()}}}));

System.register("chunks:///_virtual/gameCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./eventMap.ts","./clientEvent.ts","./axios.min.js","./axios.min.mjs_cjs=&original=.js","./recorder.mp3.min.js","./recorder.mp3.min.mjs_cjs=&original=.js","./howler.min.js","./howler.min.mjs_cjs=&original=.js"],(function(t){"use strict";var e,n,o,i,r,s,a,c,l,p,u,h,f,d,g,m,y,v,k,_;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,o=t.initializerDefineProperty,i=t.assertThisInitialized,r=t.createClass},function(t){s=t.cclegacy,a=t._decorator,c=t.Button,l=t.Label,p=t.Node,u=t.Component},function(t){h=t.SPEAK_WORDS,f=t.PLAY_TALKING_ANI,d=t.PLAY_HEAD_ANI,g=t.STOP_HEAD_ANI,m=t.PLAY_STANDING_ANI},function(t){y=t.ClientEvent},function(t){v=t.default},null,function(t){k=t.default},null,function(t){_=t.default},null],execute:function(){var E,R,j,A,b,T,C;s._RF.push({},"7b3cc31ySlIi4oMBXjxSfJL","gameCtrl",void 0);var L=a.ccclass,S=(a.property,a.type);t("gameCtrl",(E=L("gameCtrl"),R=S(c),j=S(l),E((T=e((b=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e=t.call.apply(t,[this].concat(r))||this,o(e,"recBtn",T,i(e)),o(e,"tipsLabel",C,i(e)),e.recording=!1,e}n(e,t);var s=e.prototype;return s.start=function(){this.openRec(),this.recBtn.node.on(p.EventType.TOUCH_START,this.startRec,this),this.recBtn.node.on(p.EventType.TOUCH_END,this.stopRec,this),this.recBtn.node.on(p.EventType.TOUCH_CANCEL,this.stopRec,this),y.on(h,this.speakByEvent,this)},s.update=function(t){},s.openRec=function(){var t=this;this.rec=k({type:"mp3",sampleRate:16e3,bitRate:16}),console.log("正在打开录音，请求麦克风权限..."),this.rec.open((function(){console.log("已打开录音，可以点击开始了"),t.authorized=!0}),(function(e,n){console.error("打开录音失败",e,n),t.authorized=!1,t.speakWord="麦克风已禁用，请在系统设置中“允许使用您的麦克风”"}))},s.startRec=function(){this.rec&&!this.recording&&(this.recording=!0,this.rec.start())},s.stopRec=function(){var t=this;this.rec&&this.rec.stop((function(e,n){console.log("录音成功",n),t.recording=!1,n<500?t.speakWord="对话时间过短，我不能完全理解你的意思～":n>6e4?t.speakWord="对话时间过长，超过60S了，请一句话描述哦～":t.sentenceRecognition(e)}),(function(e){console.log("录音失败",e),t.speakWord="小薇打瞌睡了，暂时无法回答你～",t.recording=!1}))},s.sentenceRecognition=function(t){var e=this,n=new FormData;n.append("file",t,"file.mp3");v.post(this.getUrlPrefix()+"asr/sentenceRecognition",n,{headers:{"Content-Type":"multipart/form-data"},methods:"post"}).then((function(t){if(t&&t.data&&0===t.data.code){var n=t.data.result;e.speakWord=n,y.dispatchEvent(f),e.speak(),console.log("一句话识别成功",n)}else console.error("一句话识别失败",t.data.msg)})).catch((function(t){console.error("一句话识别失败",t)}))},s.speak=function(){var t=this;this.stopSpeak();var e=this.getUrlPrefix()+"tts/textToVoice?text="+this.speakWord+"&type=mp3";this.player=new _.Howl({src:[e],autoplay:!0,volume:1,format:["mp3"],onend:function(){t.stopSpeak()},onplayerror:function(){t.speakWord="糟糕，连接出现小故障，请稍后～"}}),y.dispatchEvent(d),this.player.play()},s.speakByEvent=function(t){console.log(t),this.speakWord=t,this.speak()},s.stopSpeak=function(){this.player&&(y.dispatchEvent(g),y.dispatchEvent(m),this.player.stop(),this.player.unload(),this.player=null)},s.getUrlPrefix=function(){return"https://ziejs.com/meta-human/"},r(e,[{key:"speakWord",get:function(){return this.tipsLabel.string},set:function(t){this.tipsLabel.string=t}}]),e}(u)).prototype,"recBtn",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=e(b.prototype,"tipsLabel",[j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=b))||A));s._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./eventMap.ts","./clientEvent.ts","./actionsCtrl.ts","./axios.min.mjs_cjs=&original=.js","./faceAniCtrl.ts","./faceNameMap.ts","./recorder.mp3.min.mjs_cjs=&original=.js","./howler.min.mjs_cjs=&original=.js","./gameCtrl.ts","./playerCtrl.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/playerCtrl.ts",["./rollupPluginModLoBabelHelpers.js","cc","./eventMap.ts","./clientEvent.ts"],(function(n){"use strict";var t,i,o,e,s,a,l,c,r,p;return{setters:[function(n){t=n.inheritsLoose},function(n){i=n.cclegacy,o=n._decorator,e=n.Animation,s=n.Component},function(n){a=n.PLAY_HELLO_ANI,l=n.PLAY_STANDING_ANI,c=n.PLAY_DANCING_ANI,r=n.PLAY_TALKING_ANI},function(n){p=n.ClientEvent}],execute:function(){var u;i._RF.push({},"cb004DiqE5H/q7xuD14+5+S","playerCtrl",void 0);var h=o.ccclass;o.property,n("playerCtrl",h("playerCtrl")(u=function(n){function i(){return n.apply(this,arguments)||this}t(i,n);var o=i.prototype;return o.start=function(){this.aniComponent=this.node.getComponent(e),this.aniComponent.on(e.EventType.FINISHED,this.onAniPlayFinished,this),p.on(a,this.playHelloAni,this),p.on(l,this.playStandingAni,this),p.on(c,this.playDancingAni,this),p.on(r,this.playTalkAni,this)},o.update=function(n){},o.playHelloAni=function(){this.aniComponent.crossFade("hello")},o.playDancingAni=function(){this.aniComponent.crossFade("dancing")},o.playTalkAni=function(){this.aniComponent.crossFade("talk")},o.playStandingAni=function(){this.aniComponent.crossFade("standing")},o.onAniPlayFinished=function(n,t){var i=t.name;console.log(i),this.aniComponent.crossFade("standing")},i}(s))||u);i._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});